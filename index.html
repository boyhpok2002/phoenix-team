<!doctype html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Đỉnh Phượng Hoàng</title>

<style>
*{ box-sizing:border-box; margin:0; padding:0; }

html,body{
  height:100%;
  font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial;
}

body{
  background:url("img/nen.jpg") center/cover no-repeat fixed;
  color:#fff;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:linear-gradient(to bottom, rgba(0,0,0,.30), rgba(0,0,0,.72));
  z-index:0;
}

.header{
  position:fixed;
  top:0; left:0; right:0;
  text-align:center;
  padding:22px 16px;
  z-index:10;
}
.title{
  font-size:clamp(34px,8vw,52px);
  font-weight:800;
  color:#ffe6a8;
  opacity:0;
  transform:translateY(14px) scale(.88);
  filter:blur(12px);
  animation:titleIn .9s cubic-bezier(.16,1,.3,1) forwards;
  text-shadow:
    0 0 6px rgba(255,255,255,.85),
    0 0 22px rgba(255,220,150,.55),
    0 6px 18px rgba(0,0,0,.6);
}
@keyframes titleIn{
  to{ opacity:1; transform:none; filter:none; }
}

.wrap{
  position:relative;
  z-index:1;
  min-height:100vh;
  padding:140px 20px 160px;
  max-width:720px;
  margin:auto;
}

.tus{
  font-size:clamp(16px,4.5vw,20px);
  line-height:1.75;
  text-indent:1em;
  text-align:justify;
  word-break:break-word;
  text-shadow:
    0 0 2px rgba(255,255,255,.9),
    0 2px 8px rgba(0,0,0,.75);
}
.tus + .tus{ margin-top:22px; }

.cursor{
  display:inline-block;
  margin-left:2px;
  animation:blink 1s infinite;
}
@keyframes blink{ 50%{ opacity:0; } }

.group-fixed{
  position:fixed;
  bottom:22px;
  left:50%;
  transform:translateX(-50%);
  z-index:10;
  width:25vw;
  height:25vw;
  max-width:130px;
  max-height:130px;
  min-width:90px;
  min-height:90px;
  border-radius:50%;
  overflow:hidden;
  animation:breathe 4s ease-in-out infinite;
  border:2px solid rgba(160,220,255,.75);
  box-shadow:
    0 0 14px rgba(120,200,255,.45),
    0 0 30px rgba(120,200,255,.35),
    0 10px 24px rgba(0,0,0,.45);
}
.group-fixed img{
  width:100%;
  height:100%;
  object-fit:cover;
}

@keyframes breathe{
  0%{ transform:translateX(-50%) scale(1); }
  50%{ transform:translateX(-50%) scale(1.06); }
  100%{ transform:translateX(-50%) scale(1); }
}

.soundBtn{
  position:fixed;
  top:8px;
  right:8px;
  z-index:20;
  width:28px;
  height:28px;
  display:grid;
  place-items:center;
  background:none;
  border:none;
  box-shadow:none;
  cursor:pointer;
  user-select:none;
  -webkit-tap-highlight-color: transparent;
  opacity:.9;
  transition: opacity .2s ease, transform .12s ease;
}

.soundBtn:hover{ opacity:1; }
.soundBtn:active{ transform: scale(.92); }

.soundBtn svg{
  width:22px;
  height:22px;
  fill:none;
  stroke:#fff;
  stroke-width:2.2;
  stroke-linecap:round;
  stroke-linejoin:round;
  filter:
    drop-shadow(0 0 3px rgba(255,255,255,.6))
    drop-shadow(0 2px 6px rgba(0,0,0,.6));
}

.soundBtn.off svg{
  stroke:rgba(255,120,120,.95);
  filter:
    drop-shadow(0 0 3px rgba(255,120,120,.7))
    drop-shadow(0 2px 6px rgba(0,0,0,.6));
}

.soundHint{
  position:fixed;
  top:64px;
  right:16px;
  z-index:20;
  font-size:12px;
  padding:8px 10px;
  border-radius:10px;
  background:rgba(0,0,0,.38);
  border:1px solid rgba(255,255,255,.18);
  color:rgba(255,255,255,.88);
  backdrop-filter: blur(8px);
  box-shadow: 0 10px 22px rgba(0,0,0,.35);
  opacity:0;
  transform: translateY(-6px);
  transition: .2s ease;
  pointer-events:none;
}
.soundHint.show{
  opacity:1;
  transform: translateY(0);
}
</style>
</head>

<body>

<div class="header">
  <div class="title">Đỉnh Phượng Hoàng</div>
</div>

<audio id="bgm" src="img/nhac.mp3" loop preload="auto"></audio>

<button id="soundBtn" class="soundBtn" type="button" aria-label="Bật/tắt nhạc">
  <svg id="iconOn" viewBox="0 0 24 24">
    <path d="M11 5 6.8 8.3H4a1 1 0 0 0-1 1v5.4a1 1 0 0 0 1 1h2.8L11 19V5Z"/>
    <path d="M15.5 8.5a4.5 4.5 0 0 1 0 7"/>
    <path d="M17.8 6.2a8 8 0 0 1 0 11.6"/>
  </svg>
  <svg id="iconOff" viewBox="0 0 24 24" style="display:none">
    <path d="M11 5 6.8 8.3H4a1 1 0 0 0-1 1v5.4a1 1 0 0 0 1 1h2.8L11 19V5Z"/>
    <path d="M16 9l5 6"/>
    <path d="M21 9l-5 6"/>
  </svg>
</button>

<div id="soundHint" class="soundHint">Chạm vào loa để bật nhạc</div>

<a href="nhom.html" class="group-fixed">
  <img src="img/nhom.jpg" alt="Ảnh nhóm">
</a>

<div class="wrap">
  <div class="tus">
    <span id="t1"></span><span id="cursor" class="cursor">|</span>
  </div>
  <div class="tus">
    <span id="t2"></span>
  </div>
</div>

<script>
const text1 = "Tuổi trẻ của chúng ta là những chuyến đi — đi cùng nhau, cười cùng nhau, và gom lại thành một bức tranh ký ức không bao giờ phai. Vì đi đâu không quan trọng, quan trọng là chúng ta đi cùng nhau.";
const text2 = "Tiền có thể thiếu, kế hoạch có thể fail, nhưng chỉ cần đủ người thì chuyến đi nào cũng trở thành kỷ niệm.";

const t1 = document.getElementById("t1");
const t2 = document.getElementById("t2");
const cursor = document.getElementById("cursor");

function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

async function typeText(el, text){
  for(let i=0;i<text.length;i++){
    el.textContent += text[i];
    let d = 26;
    const ch = text[i];
    if(".!?".includes(ch)) d += 220;
    else if(ch === ",") d += 120;
    else if(ch === "—") d += 90;
    d += Math.random() * 18;
    await sleep(d);
  }
}

async function run(){
  await typeText(t1, text1);
  await sleep(450);
  t2.insertAdjacentElement("afterend", cursor);
  await typeText(t2, text2);
}

run();

const bgm = document.getElementById("bgm");
const soundBtn = document.getElementById("soundBtn");
const iconOn = document.getElementById("iconOn");
const iconOff = document.getElementById("iconOff");
const hint = document.getElementById("soundHint");

function setUI(isOn){
  if(isOn){
    soundBtn.classList.remove("off");
    iconOn.style.display = "";
    iconOff.style.display = "none";
  }else{
    soundBtn.classList.add("off");
    iconOn.style.display = "none";
    iconOff.style.display = "";
  }
}

async function tryAutoPlay(){
  try{
    bgm.volume = 0.4;
    await bgm.play();
    setUI(true);
  }catch{
    setUI(false);
    hint.classList.add("show");
    setTimeout(()=>hint.classList.remove("show"), 2200);
  }
}

tryAutoPlay();

soundBtn.addEventListener("click", async () => {
  if(!bgm.paused){
    bgm.pause();
    setUI(false);
    return;
  }
  try{
    await bgm.play();
    setUI(true);
  }catch{
    setUI(false);
    hint.textContent = "Trình duyệt chặn phát nhạc, hãy thử chạm lại";
    hint.classList.add("show");
    setTimeout(()=>hint.classList.remove("show"), 2200);
  }
});

document.addEventListener("visibilitychange", () => {
  setUI(!bgm.paused);
});
</script>

</body>
</html>
